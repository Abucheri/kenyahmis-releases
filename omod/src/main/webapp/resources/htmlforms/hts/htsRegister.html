<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
-->
<htmlform>

    <script>

        function disableFields() {
            var table = document.getElementById("table");
            for (var i = 0, row; row = table.rows[i]; i++) {
                var baselineHivStatus = $(row).find('.baseline-hiv-status select').val();

                if (baselineHivStatus == 664) {     //negative
                    $(row).find('.in-care select').attr('disabled', true);
                    $(row).find('.ccc-no input').attr('disabled', true);
                    $(row).find('.referring-facility input').attr('disabled', true);
                    $(row).find('.next-hivtest-date input').attr('disabled', false);
                    $(row).find('.hiv-status').attr('disabled', false);
                }
                if (baselineHivStatus == 703)  {                     //positive
//                       $(row).find('.in-care select').val('');
//                       $(row).find('.ccc-no input').val('');
                    $(row).find('.in-care select').attr('disabled', false);
                    $(row).find('.ccc-no input').attr('disabled', false);
                    $(row).find('.referring-facility input').attr('disabled', false);
                    $(row).find('.next-hivtest-date input').attr('disabled', true);
                    $(row).find('.hiv-result select').attr('disabled', true);
                }
            }
        }


        $(document).ready(function () {

            disableFields();

            $(".hiv-result select").change(function () {
                var row = $(this).parent().parent().parent();
                var baseline = $(".baseline-hiv-status :selected").text();
               // console.log("Baseline " + baseline);
                if (this.value == 664 &amp;&amp; baseline !='Positive') {    //negative
                    $(row).find('.in-care select').attr('disabled', true);
                    $(row).find('.ccc-no input').attr('disabled', true);
                    $(row).find('.referring-facility input').attr('disabled',true);
                    $(row).find('.next-hivtest-date input').attr('disabled', false);
                    $(row).find('.hiv-result select').attr('disabled', false);
                    //Clearing fields
                    $(row).find('.referring-facility input').val('');
                    $(row).find('.ccc-no input').val('');

                } else {                     //positive

                    $(row).find('.in-care select').attr('disabled', false);
                    $(row).find('.ccc-no input').attr('disabled', false);
                    $(row).find('.referring-facility input').attr('disabled', false);
                    $(row).find('.next-hivtest-date input').attr('disabled', true);
                    $(row).find('.hiv-status select').attr('disabled', true);
                    //Clearing fields
                    $(row).find('.hiv-result input').val('');
                    $(row).find('.next-hivtest-date input').val('');
                }
            });

            $(".baseline-hiv-status  select").change(function () {
                var row = $(this).parent().parent().parent();

                if (this.value == 664) {    //negative
                    $(row).find('.in-care select').attr('disabled', true);
                    $(row).find('.ccc-no input').attr('disabled', true);
                    $(row).find('.referring-facility input').attr('disabled', true);
                    $(row).find('.next-hivtest-date input').attr('disabled', false);
                    $(row).find('.hiv-result select').attr('disabled', false);
                    //Clearing fields
                    $(row).find('.referring-facility input').val('');
                    $(row).find('.ccc-no input').val('');

                }
                if(this.value == 703) {                     //positive
                    $(row).find('.in-care select').attr('disabled', false);
                    $(row).find('.ccc-no input').attr('disabled', false);
                    $(row).find('.referring-facility input').attr('disabled', false);
                    $(row).find('.next-hivtest-date input').attr('disabled', true);
                    $(row).find('.hiv-result select').attr('disabled', true);
                    //Clearing fields
                    $(row).find('.hiv-result input').val('');
                    $(row).find('.next-hivtest-date input').val('');

                }
            });

        });
    </script>

    <!-- Encounter date, provider and location are not relevant for CE forms -->
    <div style="display:none">
        <encounterDate id="encounter-date" showTime="true" />
        <encounterProvider default="ae01b8ff-a4cc-4012-bcf7-72359e852e14"/>
        <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation"/>
    </div>

    <div class="ke-form-content">
        <table id="table" width="100%">
            <thead>
            <tr>
                <th align="left">Population Type</th>
                <th align="left">Ever Tested</th>
                <th align="left">Retest(Months)</th>
                <th align="left">Disability</th>
                <th align="left">Informed Consent</th>
                <th align="left">Tested as Couple</th>
                <th align="left">HTS Strategy</th>
                <th align="left">HIV Test 1 Result</th>
                <th align="left">Kit Name</th>
                <th align="left">Lot No.</th>
                <th align="left">Expiry Date</th>
                <th align="left">HIV Test 2 Result</th>
                <th align="left">Kit Name</th>
                <th align="left">Lot No.</th>
                <th align="left">Expiry Date</th>
                <th align="left">HIV Result</th>
                <th align="left">Result Given?</th>
                <th align="left">Couple Discordant</th>
                <th align="left">TB Screening Results</th>
                <th align="left">Linked to Care</th>
                <th align="left">HIV Self Test This Year</th>
                <th align="left">Provider Name</th>
                <th align="left">Remarks</th>
            </tr>
            </thead>
            <tbody>
            <repeat>
                <template>
                    <obsgroup groupingConceptId="160593AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">

                        <tr>
                            <td>

                                <obs class="population-type"  conceptId="160581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160579AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160578AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,105AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="N/A,SW,MSM,IDU,Other"/>
                            </td>
                            <td>
                                <obs class="ever-tested" conceptId="164401AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="YES,NO"/>
                            </td>
                            <td>
                                <obs class="retest-duration" conceptId="159813AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />

                            </td>

                            <td>
                                <obs class="disability" conceptId="162558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="120291AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,147215AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,151342AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164538AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="Deaf,Blind,Mental,Physical,Other"/>
                            </td>
                            <td>
                                <obs class="consent" conceptId="1710AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="yes_no" />
                            </td>
                            <td>
                                <obs class="partner-tested" conceptId="161557AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="YES,NO"/>
                            </td>
                            <td>
                                <obs class="hts-strategy"
                                     conceptId="160540AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="164163AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,161557AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160539AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159938AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159939AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="HP,NP,VI,VS,HBTC,MO,Other"
                            />
                            </td>
                            <td>
                                <obs class="hiv-test1-result" conceptId="1040AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="Positive,Negive,Inconclusive"/>
                            </td>
                            <td>
                                <!--<obs class="kit-name"-->
                                     <!--conceptId="1040AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"-->
                                      <!--answerConceptId="162401AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels=" "-->
                                <!--/>-->
                                <input type="text" name="kit-name" />
                            </td>
                            <td>
                                <!--<obs class="lot-number"-->
                                     <!--conceptId="1040AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"-->
                                     <!--answerConceptId="162398AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"-->
                                <!--/>-->
                                <input type="text" name="lot-number" />
                            </td>
                            <td>
                                <obs class="expiry-date" conceptId="162502AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                />
                            </td>
                            <td>
                                <obs class="hiv-test2-result" conceptId="1326AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="Positive,Negive,Inconclusive"/>
                            </td>
                            <td>
                                <!--<obs class="kit-name" style="text"-->
                                     <!--conceptId="1326AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"-->
                                     <!--answerConceptId="162401AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"-->
                                <!--/>-->
                                <input type="text" name="kit-name" />
                            </td>
                            <td>
                                <!--<obs class="lot-number"-->
                                     <!--conceptId="1326AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"-->
                                     <!--answerConceptId="162398AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"-->
                                <!--/>-->
                                <input type="text" name="lot-number" />
                            </td>
                            <td>
                                <obs class="expiry-date" conceptId="162502AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                />
                            </td>

                            <td>
                                <obs class="hiv-final-result" conceptId="159427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="Positive,Negive,Inconclusive"/>
                            </td>
                            <td>
                                <obs class="result-given" conceptId="164401AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="YES,NO"/>
                            </td>
                            <td>
                                <obs class="couple-discordant" conceptId="6096AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="YES,NO,N/A"/>
                            </td>
                            <td>
                                <obs id="tb-screening" conceptId="1659AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  answerConceptIds="1660AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142177AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1662AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="No TB Signs,Presumed TB,TB Confirmed,Not Done" />
                        </td>
                            <td>
                                <obs class="in-care" conceptId="159811AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown" answerLabels="YES,NO,N/A"/>
                            </td>
                            <td>
                                <obs class="hb-self-test" conceptId="1492AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="yes_no" />
                            </td>
                            <td>
                                <obs class="provider-name" conceptId="1473AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                />
                            </td>
                            <td>
                                <obs class="remarks" conceptId="163761AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                />
                            </td>
                        </tr>
                    </obsgroup>
                </template>
                <render n="1" concept=" "/>
                <render n="2" concept=" "/>
                <render n="3" concept=" "/>
                <render n="4" concept=" "/>
                <render n="5" concept=" "/>
                <render n="6" concept=" "/>
                <render n="7" concept=" "/>
                <render n="8" concept=" "/>
                <render n="9" concept=" "/>
                <render n="10" concept=" "/>
            </repeat>
            </tbody>
        </table>
    </div>

    <div class="ke-form-footer">
        <submit/>
    </div>

</htmlform>